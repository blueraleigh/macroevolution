% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rcm_dmm.R
\name{read.rcm.dmm}
\alias{read.rcm.dmm}
\title{Read the output file from \code{make.rcm.dmm} into R}
\usage{
read.rcm.dmm(output.file, skip = 0, n = -1)
}
\arguments{
\item{output.file}{Name of the output file.}

\item{skip}{Number of rows in the file to skip over before reading. Defaults to 0.}

\item{n}{Number of rows to read. If -1 (default) all rows (after any skipped
rows) are read until the end of file is reached.}
}
\value{
A list with the following structure
\describe{
\item{r}{The number of states in the prior model.}
\item{integrate.brlen}{Were branch lengths integrated out.}
\item{pars}{A numeric matrix whose rows correspond to posterior samples. The
first column contains the log likelihood of the data conferred by the specific
configuration of state assignments in the sample. The second column contains
the prior probability of the state configuration under the Markov model. The
third column contains the rate of the Markov model.}
\item{stateid}{An integer matrix that records the index of the state sampled
for each terminal taxon in each posterior sample. Note that the indices of
states in one sample do not necessarily align with the indices in another.}}
\item{dirichlet.prior}{The hyperparameters of the Dirichlet prior.}
\item{dataset}{The count dataset used for analysis. The first column holds the
terminal node indices, the second column holds the resource category indices,
and the third column holds the number of observations for the particular
combination of indices in columns one and two. Note that the indices in the
first two columns are 0-based, following C (not R) convention. Also, resource
category indices correspond to the name ordering in the \code{dirichlet.prior}
list member. Thus, index 0 corresponds to the first named element of
of \code{dirichlet.prior}; index 1, to the second; and so on.}
\item{phy}{The phylogeny used for analysis.}
}
\description{
Read the output file from \code{make.rcm.dmm} into R
}
\details{
The output file is a special binary file with the
following header format.
\tabular{rrl}{
Offset \tab Size  \tab  Description\cr
0      \tab 4     \tab  Number of resource categories (= J)\cr
4      \tab 4     \tab  Number of resource states (= K)\cr
8      \tab 4     \tab  Flag indicating if branch lengths are integrated out\cr
12     \tab 4     \tab  Number of rows in the input data matrix (= M)\cr
16     \tab 4     \tab  Number of terminal taxa (= N)\cr
20     \tab 4     \tab  Number of characters in the Newick string for the input phylogeny\cr
24     \tab X     \tab  An array of strings giving the names of the terminal taxa\cr
24+X   \tab Y     \tab  An array of strings giving the names of the resource categories\cr
24+X+Y \tab 12M   \tab  An array of integers giving the input dataset\cr
24+X+Y+12M \tab Z \tab  The Newick string\cr
24+X+Y+12M+Z \tab 8J \tab The hyperparameters of the Dirichlet prior
}

Note that byte offsets assume 1 byte chars, 4 byte integers, and 8 byte doubles.
After the header is the payload. The first entry in the payload is the initial state
configuration and hyperparameter values that were used to start the MCMC run.
The payload has the following repetitive structure, where W initially equals
24+X+Y+12M+Z+8J and is incremented by 24+4N for each posterior sample.

\tabular{rrl}{
Offset  \tab   Size \tab  Description\cr
W       \tab   8    \tab  The data log likelihood\cr
W+8     \tab   8    \tab  The log prior probability\cr
W+16    \tab   8    \tab  The rate of the Poisson prior\cr
W+24    \tab   4N   \tab  The state assignments of the terminal taxa
}
}
